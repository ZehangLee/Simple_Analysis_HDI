figure2<-ggplot(month.melt,as.numeric = FALSE,aes(x = Time, y = value,color=variable))+
theme_minimal()+
labs(
title = "Figure 2. Primary Energy Production by Sources Overview (Monthly Data)",
subtitle = "1973. Jan – 2018.Dec",
caption = "Data source: https://www.eia.gov/totalenergy/",
x = ' ',
y = ' ')+
theme(plot.title = element_text(size=12,
hjust = 0,
vjust = 2,
face = "bold"),
plot.subtitle =  element_text(size=10,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold",
hjust=0.95),
axis.text.x = element_text(angle=90),
legend.title=element_blank(),
legend.justification = c(0.2, 0),
legend.margin = margin(c(5, 5, 5, 0)),
legend.text = element_text(margin = margin(r = 10, unit = "pt")),
legend.key.width = unit(2, "line"))+
geom_line(size=1)+
scale_color_manual(values=c("brown", "#0066CC","#000000","#006600","darkred","#FFCC33"))+
scale_x_datetime(NULL, breaks = anual$Year, date_labels = "%Y")+
theme(legend.position = "bottom")+
scale_y_continuous(breaks=seq(0, 3000, 500),limits = c(0, 3000))+
guides(colour = guide_legend(nrow = 1))
#900*300
figure2
figure1a2<-ggarrange(figure1, figure2, ncol = 1, nrow = 2)
figure1a2
figure5.1<-
ggplot(data = ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 3. Coal Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FC4E07",
fill = "#FC4E07",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")+
scale_y_continuous(breaks=seq(200, 1200, 100),limits = c(200, 1200))
figure5.1
figure5.1<-
ggplot(data = ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 3. Coal Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill ="#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")+
scale_y_continuous(breaks=seq(200, 1200, 100),limits = c(200, 1200))
figure5.1
renew.total.acf <- acf(ts.renew.total, plot = FALSE)
renew.total.acf.df <- with(renew.total.acf, data.frame(lag, acf))
renew.total.pacf <- acf(ts.renew.total, type = "partial", plot = FALSE)
renew.total.pacf.df <- data.frame(lag = renew.total.pacf$lag,pacf = renew.total.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(ts.renew.total)))
figure5.acf<-ggplot(data = renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure5.pacf<-ggplot(data = renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure5.1,
ggarrange(figure5.acf, figure5.pacf, ncol = 2),
nrow = 2)
figure5.acf<-ggplot(data = renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure5.pacf<-ggplot(data = renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure5.1,
ggarrange(figure5.acf, figure5.pacf, ncol = 2),
nrow = 2)
figure5.1<-
ggplot(data = ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 5. Renewable Energy Source Total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill ="#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")+
scale_y_continuous(breaks=seq(200, 1200, 100),limits = c(200, 1200))
figure5.1
renew.total.acf <- acf(ts.renew.total, plot = FALSE)
renew.total.acf.df <- with(renew.total.acf, data.frame(lag, acf))
renew.total.pacf <- acf(ts.renew.total, type = "partial", plot = FALSE)
renew.total.pacf.df <- data.frame(lag = renew.total.pacf$lag,pacf = renew.total.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(ts.renew.total)))
figure5.acf<-ggplot(data = renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure5.pacf<-ggplot(data = renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure5.1,
ggarrange(figure5.acf, figure5.pacf, ncol = 2),
nrow = 2)
## take log and 2st diff
log.ts.renew.total=log(ts.renew.total)
first.ts.renew.total=diff(log.ts.renew.total)
second.log.ts.renew.total=diff(first.ts.renew.total,lag = 12)
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 4. 12th Difference of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#0066CC", size = 1)+
stat_smooth(color = "#FC4E07",
fill = "#FC4E07",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure4.1
figure6.1
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 4. 12th Difference of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill = "#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure6.1
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 6. Second Difference (lag=12) of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill = "#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure6.1
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 6. Second Difference (Lag=12) of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill = "#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure6.1
sl.renew.total.acf <- acf(second.log.ts.renew.total, plot = FALSE)
sl.renew.total.acf.df <- with(sl.renew.total.acf, data.frame(lag, acf))
sl.renew.total.pacf <- acf(second.log.ts.renew.total, type = "partial", plot = FALSE)
sl.renew.total.pacf.df <- data.frame(lag = sl.renew.total.pacf$lag,pacf = sl.renew.total.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(second.log.ts.renew.total)))
figure6.acf<-ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF of 12th Difference")
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure6.1,
ggarrange(figure6.acf, figure6.pacf, ncol = 2),
nrow = 2)
ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2))+
ggtitle("ACF of 12th Difference")
ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2))+
ggtitle("ACF of 12th Difference")
ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
figure6.acf<-ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2))+
ggtitle("ACF of 12th Difference")
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure6.1,
ggarrange(figure6.acf, figure6.pacf, ncol = 2),
nrow = 2)
figure6.acf<-ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2))+
ggtitle("ACF of 12th Difference")
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure6.1,
ggarrange(figure6.acf, figure6.pacf, ncol = 2),
nrow = 2)
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,100,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
figure6.pacf
fit.coal<-auto.arima(second.log.ts.coal,order=c(3,1,1),sorder=c(0,1,1),method = "CSS-ML")
fit.coal<-auto.arima(second.log.ts.coal,order=c(3,1,1),seasonal=c(0,1,1),method = "CSS-ML")
fit.coal
fit.coal<-auto.arima(second.log.ts.coal,order=c(3,1,1),seasonal=c(0,1,1),method = "CSS-ML")
fit.coal<-auto.arima(ts.fossil.coal,order=c(3,1,1),seasonal=c(0,1,1),method = "CSS-ML")
fit.coal<-auto.arima(ts.fossil.coal,order=c(3,1,1),seasonal=c(0,1,1))
View(ts.fossil.coal)
fit.coal<-auto.arima(log(ts.fossil.coal),order=c(3,1,1),seasonal=list(order=c(0,1,1),period=12))
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),seasonal=list(order=c(0,1,1),period=12))
fit.coal
## for the coal
# MLE
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="ML")
fit.coal
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS-ML")
fit.coal
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS")
fit.coal
knitr::kable(fit.coal$coef)
fit.coal.MLE<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="ML")
fit.coal.MLE
fit.coal.CSSMLE<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS-ML")
fit.coal.CSSMLE
fit.coal.CSS<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS")
knitr::kable(fit.coal.MLE$coef,fit.coal.CSSMLE$coef,fit.coal.CSS$coef)
coef<-cbind(fit.coal.MLE$coef,fit.coal.CSSMLE$coef,fit.coal.CSS$coef)
View(coef)
knitr::kable(coef)
## take log and 2st diff
log.ts.fossil.coal=log(ts.fossil.coal)
first.ts.fossil.coal=diff(log.ts.fossil.coal)
second.log.ts.coal=diff(first.ts.fossil.coal,lag = 12)
figure4.1<-ggplot(data = second.log.ts.coal, as.numeric = FALSE)+
labs(
title = "Figure 4. Second Difference (Lag-12) of Log Transformed Coal Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#0066CC", size = 1)+
stat_smooth(color = "#FC4E07",
fill = "#FC4E07",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure4.1
fl.coal.acf <- acf(second.log.ts.coal, plot = FALSE)
fl.coal.acf.df <- with(fl.coal.acf, data.frame(lag, acf))
fl.coal.pacf <- acf(second.log.ts.coal, type = "partial", plot = FALSE)
fl.coal.pacf.df <- data.frame(lag = fl.coal.pacf$lag,pacf = fl.coal.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(second.log.ts.coal)))
figure4.acf<-ggplot(data = fl.coal.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF of 12th Difference")
figure4.pacf<-ggplot(data = fl.coal.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure4.1,
ggarrange(figure4.acf, figure4.pacf, ncol = 2),
nrow = 2)
figure4.acf<-ggplot(data = fl.coal.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure4.pacf<-ggplot(data = fl.coal.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure4.1,
ggarrange(figure4.acf, figure4.pacf, ncol = 2),
nrow = 2)
acf(second.log.ts.coal)
pacf(second.log.ts.coal)
knitr::kable(coef)
fit.coal.MLE<-arima(log(ts.fossil.coal),order=c(2,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="ML")
fit.coal.MLE
fit.coal.CSSMLE<-arima(log(ts.fossil.coal),order=c(2,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS-ML")
fit.coal.CSSMLE
fit.coal.CSS<-arima(log(ts.fossil.coal),order=c(2,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS")
fit.coal.CSS
coef<-cbind(fit.coal.MLE$coef,fit.coal.CSSMLE$coef,fit.coal.CSS$coef)
knitr::kable(coef)
## for the renew
# MLE
fit.renew.MLE<-arima(second.log.ts.renew.total,order=c(1,1,1),
seasonal=list(order=c(1,1,1),period=12),
method="ML")
fit.renew.MLE
fit.renew.CSSMLE<-arima(second.log.ts.renew.total,order=c(1,1,1),
seasonal=list(order=c(1,1,1),period=12),
method="CSS-ML")
fit.renew.CSSMLE
fit.renew.CSS<-arima(second.log.ts.renew.total,order=c(1,1,1),
seasonal=list(order=c(1,1,1),period=12),
method="CSS")
fit.renew.CSS
coef.renew<-cbind(fit.renew.MLE$coef,fit.renew.CSSMLE$coef,fit.renew.CSS$coef)
knitr::kable(coef.renew)
auto.arima(second.log.ts.coal,seasonal = TRUE)
auto.arima(ts.coal,seasonal = TRUE)
auto.arima(ts.fossil.coal,seasonal = TRUE)
auto.arima(ts.fossil.coal,seasonal = TRUE,ic="bic")
figure1a2<-ggarrange(figure1, figure2, ncol = 1, nrow = 2)
figure1a2
