<<<<<<< HEAD
figure2<-ggplot(month.melt,as.numeric = FALSE,aes(x = Time, y = value,color=variable))+
theme_minimal()+
labs(
title = "Figure 2. Primary Energy Production by Sources Overview (Monthly Data)",
subtitle = "1973. Jan – 2018.Dec",
caption = "Data source: https://www.eia.gov/totalenergy/",
x = ' ',
y = ' ')+
theme(plot.title = element_text(size=12,
hjust = 0,
vjust = 2,
face = "bold"),
plot.subtitle =  element_text(size=10,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold",
hjust=0.95),
axis.text.x = element_text(angle=90),
legend.title=element_blank(),
legend.justification = c(0.2, 0),
legend.margin = margin(c(5, 5, 5, 0)),
legend.text = element_text(margin = margin(r = 10, unit = "pt")),
legend.key.width = unit(2, "line"))+
geom_line(size=1)+
scale_color_manual(values=c("brown", "#0066CC","#000000","#006600","darkred","#FFCC33"))+
scale_x_datetime(NULL, breaks = anual$Year, date_labels = "%Y")+
theme(legend.position = "bottom")+
scale_y_continuous(breaks=seq(0, 3000, 500),limits = c(0, 3000))+
guides(colour = guide_legend(nrow = 1))
#900*300
figure2
figure1a2<-ggarrange(figure1, figure2, ncol = 1, nrow = 2)
figure1a2
figure5.1<-
ggplot(data = ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 3. Coal Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FC4E07",
fill = "#FC4E07",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")+
scale_y_continuous(breaks=seq(200, 1200, 100),limits = c(200, 1200))
figure5.1
figure5.1<-
ggplot(data = ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 3. Coal Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill ="#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")+
scale_y_continuous(breaks=seq(200, 1200, 100),limits = c(200, 1200))
figure5.1
renew.total.acf <- acf(ts.renew.total, plot = FALSE)
renew.total.acf.df <- with(renew.total.acf, data.frame(lag, acf))
renew.total.pacf <- acf(ts.renew.total, type = "partial", plot = FALSE)
renew.total.pacf.df <- data.frame(lag = renew.total.pacf$lag,pacf = renew.total.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(ts.renew.total)))
figure5.acf<-ggplot(data = renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure5.pacf<-ggplot(data = renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure5.1,
ggarrange(figure5.acf, figure5.pacf, ncol = 2),
nrow = 2)
figure5.acf<-ggplot(data = renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure5.pacf<-ggplot(data = renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure5.1,
ggarrange(figure5.acf, figure5.pacf, ncol = 2),
nrow = 2)
figure5.1<-
ggplot(data = ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 5. Renewable Energy Source Total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill ="#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")+
scale_y_continuous(breaks=seq(200, 1200, 100),limits = c(200, 1200))
figure5.1
renew.total.acf <- acf(ts.renew.total, plot = FALSE)
renew.total.acf.df <- with(renew.total.acf, data.frame(lag, acf))
renew.total.pacf <- acf(ts.renew.total, type = "partial", plot = FALSE)
renew.total.pacf.df <- data.frame(lag = renew.total.pacf$lag,pacf = renew.total.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(ts.renew.total)))
figure5.acf<-ggplot(data = renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure5.pacf<-ggplot(data = renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure5.1,
ggarrange(figure5.acf, figure5.pacf, ncol = 2),
nrow = 2)
## take log and 2st diff
log.ts.renew.total=log(ts.renew.total)
first.ts.renew.total=diff(log.ts.renew.total)
second.log.ts.renew.total=diff(first.ts.renew.total,lag = 12)
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 4. 12th Difference of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#0066CC", size = 1)+
stat_smooth(color = "#FC4E07",
fill = "#FC4E07",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure4.1
figure6.1
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 4. 12th Difference of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill = "#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure6.1
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 6. Second Difference (lag=12) of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill = "#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure6.1
figure6.1<-ggplot(data = second.log.ts.renew.total, as.numeric = FALSE)+
labs(
title = "Figure 6. Second Difference (Lag=12) of Log Transformed renew.total Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#006600", size = 1)+
stat_smooth(color = "#FFCC33",
fill = "#FFCC33",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure6.1
sl.renew.total.acf <- acf(second.log.ts.renew.total, plot = FALSE)
sl.renew.total.acf.df <- with(sl.renew.total.acf, data.frame(lag, acf))
sl.renew.total.pacf <- acf(second.log.ts.renew.total, type = "partial", plot = FALSE)
sl.renew.total.pacf.df <- data.frame(lag = sl.renew.total.pacf$lag,pacf = sl.renew.total.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(second.log.ts.renew.total)))
figure6.acf<-ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF of 12th Difference")
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure6.1,
ggarrange(figure6.acf, figure6.pacf, ncol = 2),
nrow = 2)
ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-1,1,0.2))+
ggtitle("ACF of 12th Difference")
ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2))+
ggtitle("ACF of 12th Difference")
ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
figure6.acf<-ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2))+
ggtitle("ACF of 12th Difference")
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure6.1,
ggarrange(figure6.acf, figure6.pacf, ncol = 2),
nrow = 2)
figure6.acf<-ggplot(data = sl.renew.total.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2))+
ggtitle("ACF of 12th Difference")
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure6.1,
ggarrange(figure6.acf, figure6.pacf, ncol = 2),
nrow = 2)
figure6.pacf<-ggplot(data = sl.renew.total.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#006600") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#006600")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,100,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
figure6.pacf
fit.coal<-auto.arima(second.log.ts.coal,order=c(3,1,1),sorder=c(0,1,1),method = "CSS-ML")
fit.coal<-auto.arima(second.log.ts.coal,order=c(3,1,1),seasonal=c(0,1,1),method = "CSS-ML")
fit.coal
fit.coal<-auto.arima(second.log.ts.coal,order=c(3,1,1),seasonal=c(0,1,1),method = "CSS-ML")
fit.coal<-auto.arima(ts.fossil.coal,order=c(3,1,1),seasonal=c(0,1,1),method = "CSS-ML")
fit.coal<-auto.arima(ts.fossil.coal,order=c(3,1,1),seasonal=c(0,1,1))
View(ts.fossil.coal)
fit.coal<-auto.arima(log(ts.fossil.coal),order=c(3,1,1),seasonal=list(order=c(0,1,1),period=12))
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),seasonal=list(order=c(0,1,1),period=12))
fit.coal
## for the coal
# MLE
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="ML")
fit.coal
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS-ML")
fit.coal
fit.coal<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS")
fit.coal
knitr::kable(fit.coal$coef)
fit.coal.MLE<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="ML")
fit.coal.MLE
fit.coal.CSSMLE<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS-ML")
fit.coal.CSSMLE
fit.coal.CSS<-arima(log(ts.fossil.coal),order=c(3,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS")
knitr::kable(fit.coal.MLE$coef,fit.coal.CSSMLE$coef,fit.coal.CSS$coef)
coef<-cbind(fit.coal.MLE$coef,fit.coal.CSSMLE$coef,fit.coal.CSS$coef)
View(coef)
knitr::kable(coef)
## take log and 2st diff
log.ts.fossil.coal=log(ts.fossil.coal)
first.ts.fossil.coal=diff(log.ts.fossil.coal)
second.log.ts.coal=diff(first.ts.fossil.coal,lag = 12)
figure4.1<-ggplot(data = second.log.ts.coal, as.numeric = FALSE)+
labs(
title = "Figure 4. Second Difference (Lag-12) of Log Transformed Coal Production (Monthly)",
subtitle = "Jan 1973 – Dec 2018",
x = ' ',
y = ' '
)+
theme_minimal()+
theme(plot.title = element_text(size=14,
hjust = 0,
face = "bold"),
plot.subtitle =  element_text(size=12,
hjust = 0,
face = "italic"),
plot.caption = element_text(face = "bold"),
axis.text.x = element_text(angle=90))+
geom_line(color = "#0066CC", size = 1)+
stat_smooth(color = "#FC4E07",
fill = "#FC4E07",
method = "loess")+
scale_x_datetime(NULL, breaks = "1 year", date_labels = "%Y")
figure4.1
fl.coal.acf <- acf(second.log.ts.coal, plot = FALSE)
fl.coal.acf.df <- with(fl.coal.acf, data.frame(lag, acf))
fl.coal.pacf <- acf(second.log.ts.coal, type = "partial", plot = FALSE)
fl.coal.pacf.df <- data.frame(lag = fl.coal.pacf$lag,pacf = fl.coal.pacf$acf)
# 95% confidence interval limits
ci <- qnorm((1 + 0.95)/2)/sqrt(sum(!is.na(second.log.ts.coal)))
figure4.acf<-ggplot(data = fl.coal.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF of 12th Difference")
figure4.pacf<-ggplot(data = fl.coal.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF of 12th Difference")
ggarrange(figure4.1,
ggarrange(figure4.acf, figure4.pacf, ncol = 2),
nrow = 2)
figure4.acf<-ggplot(data = fl.coal.acf.df, mapping = aes(x = lag, y = acf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(0,1,0.2))+
ggtitle("ACF")
figure4.pacf<-ggplot(data = fl.coal.pacf.df, mapping = aes(x = lag, y = pacf)) +
geom_hline(aes(yintercept = 0),color="#0066CC") +
geom_segment(mapping = aes(xend = lag, yend = 0),size=1.5,color="#0066CC")+
geom_hline(yintercept=c(ci, -ci), linetype="dashed",color="sandybrown",size=1.1) +
theme_minimal()+
scale_x_continuous(breaks = seq(0,30,1),"Lag")+
scale_y_continuous(name=element_blank(),breaks = seq(-0.4,1,0.2),limits = c(-0.4,1))+
ggtitle("PACF")
ggarrange(figure4.1,
ggarrange(figure4.acf, figure4.pacf, ncol = 2),
nrow = 2)
acf(second.log.ts.coal)
pacf(second.log.ts.coal)
knitr::kable(coef)
fit.coal.MLE<-arima(log(ts.fossil.coal),order=c(2,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="ML")
fit.coal.MLE
fit.coal.CSSMLE<-arima(log(ts.fossil.coal),order=c(2,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS-ML")
fit.coal.CSSMLE
fit.coal.CSS<-arima(log(ts.fossil.coal),order=c(2,1,1),
seasonal=list(order=c(0,1,1),period=12),
method="CSS")
fit.coal.CSS
coef<-cbind(fit.coal.MLE$coef,fit.coal.CSSMLE$coef,fit.coal.CSS$coef)
knitr::kable(coef)
## for the renew
# MLE
fit.renew.MLE<-arima(second.log.ts.renew.total,order=c(1,1,1),
seasonal=list(order=c(1,1,1),period=12),
method="ML")
fit.renew.MLE
fit.renew.CSSMLE<-arima(second.log.ts.renew.total,order=c(1,1,1),
seasonal=list(order=c(1,1,1),period=12),
method="CSS-ML")
fit.renew.CSSMLE
fit.renew.CSS<-arima(second.log.ts.renew.total,order=c(1,1,1),
seasonal=list(order=c(1,1,1),period=12),
method="CSS")
fit.renew.CSS
coef.renew<-cbind(fit.renew.MLE$coef,fit.renew.CSSMLE$coef,fit.renew.CSS$coef)
knitr::kable(coef.renew)
auto.arima(second.log.ts.coal,seasonal = TRUE)
auto.arima(ts.coal,seasonal = TRUE)
auto.arima(ts.fossil.coal,seasonal = TRUE)
auto.arima(ts.fossil.coal,seasonal = TRUE,ic="bic")
figure1a2<-ggarrange(figure1, figure2, ncol = 1, nrow = 2)
figure1a2
=======
group_by(year,country_name)%>%  summarise(avg = mean(hdi))
colnames(heal.life2)[2]="Region"
heal.life <- rbind(heal.life1,heal.life2)
colnames(heal.life)[2]="geo"
#
# heal.life1=hdi.databank.m %>%
#   filter( Region %in% heal.geography.in) %>%
#   filter((year>= date_from) & (year<= date_to)) %>%
#   filter( indicator_name =="Life expectancy at birth (years)")%>%
#   group_by(year,country_name)
# radar=ggradar(heal.overview.final,grid.mid = 50,grid.max = 100)
# hiv.plot=ggplot(data=heal.overview.final,mapping = aes(x=geo,y=`HIV.prevalence.adult.(per.1000.ages.15-49)`))+
#   geom_bar(stat="identity")+
#   coord_flip()
}else{
heal.overview <- hdi.databank.m %>%
filter( level %in% heal.level.in) %>%
filter((year>= date_from) & (year<= date_to)) %>%
replace_na(list(hdi=0))%>%
group_by(level,indicator_name)%>%summarise(avg = mean(hdi))
heal.overview.final=heal.overview%>%spread(indicator_name,avg)
colnames(heal.overview.final)=gsub(" ",".",colnames(heal.overview.final))
colnames(heal.overview.final)=gsub(",","",colnames(heal.overview.final))
#colnames(heal.overview.final)=gsub("(","",colnames(heal.overview.final))
#colnames(heal.overview.final)=gsub(")","",colnames(heal.overview.final))
heal.overview.final=heal.overview.final[,c("level",
"Current.health.expenditure.(%.of.GDP)",
"HIV.prevalence.adult.(%.ages.15-49)",
"Life.expectancy.at.birth.(years)",
"Mortality.rate.infant.(per.1000.live.births)",
"Mortality.rate.under-five.(per.1000.live.births)")]
heal.overview.final[is.na(heal.overview.final)]=0
heal.overview.final$`HIV.prevalence.adult.(%.ages.15-49)`=heal.overview.final$`HIV.prevalence.adult.(%.ages.15-49)`*10
colnames(heal.overview.final)[3]="HIV.prevalence.adult.(per.1000.ages.15-49)"
heal.life=hdi.databank.m %>%
filter( level %in%  heal.level.in) %>%
filter((year>= date_from) & (year<= date_to)) %>%
filter( indicator_name =="Life expectancy at birth (years)")%>%
select(level,year,hdi)%>%arrange(year,level)%>%drop_na(hdi)%>%
group_by(year,level)%>%  summarise(avg = mean(hdi))
# radar=ggradar(heal.overview.final,grid.mid = 50,grid.max = 100)
# hiv.plot=ggplot(data=heal.overview.final,mapping = aes(x=level,y=`HIV.prevalence.adult.(per.1000.ages.15-49)`))+
#   geom_bar(stat="identity")+
#   coord_flip()
}
return(heal.overview.final)
}
heal.level.in=as.null()
#heal.level.in=c("VERY HIGH HUMAN DEVELOPMENT","LOW HUMAN DEVELOPMENT","MEDIUM HUMAN DEVELOPMENT","HIGH HUMAN DEVELOPMENT")
heal.overview.test=test_heal_plot_fun(heal.level.in,date_from=2013,date_to=2016,
heal.geography.in=c("Arab State","Botswana","Central African Republic","Congo"),plot_type = "")
View(heal.overview.test)
ggradar(heal.overview.final,grid.mid = 50,grid.max = 100)
ggradar(heal.overview.test,grid.mid = 50,grid.max = 100)
View(heal.overview.test)
which.max(heal.overview.test)
View(heal.overview.test)
which.max(heal.overview.test[,2:6])
which.max(heal.overview.test[6])
max(heal.overview.test[6])
max(heal.overview.test)
max(heal.overview.test[2:6])
ggradar(heal.overview.test,grid.mid = 50,grid.max = max(heal.overview.test)+10)
grid.max=max(heal.overview.test)+10
max(heal.overview.test)+10
ggradar(heal.overview.test,grid.mid = 50,grid.max = max(heal.overview.test[,2:6])+10)
runApp('hdi')
test_heal_plot_fun=function(heal.level.in,heal.geography.in,date_from,date_to,plot_type){
if (is.null(heal.level.in)==TRUE){
heal.overview1 <- hdi.databank.m %>%
filter( Region %in% heal.geography.in) %>%
filter((year>= date_from) & (year<= date_to)) %>%
replace_na(list(hdi=0))%>%
group_by(Region,indicator_name)%>%summarise(avg = mean(hdi))
heal.overview2 <- hdi.databank.m %>%
filter(country_name %in% heal.geography.in) %>%
filter((year>= date_from) &(year<= date_to)) %>%
replace_na(list(hdi=0))%>%
group_by(country_name,indicator_name)%>%summarise(avg = mean(hdi))
colnames(heal.overview2)[1]="Region"
heal.overview <- rbind(heal.overview1,heal.overview2)
# heal.overview %>%
#   mutate_at(vars(avg),funs(rescale))
heal.overview.final=heal.overview%>%spread(indicator_name,avg)
colnames(heal.overview.final)[1]="geo"
colnames(heal.overview.final)=gsub(" ",".",colnames(heal.overview.final))
colnames(heal.overview.final)=gsub(",","",colnames(heal.overview.final))
#colnames(heal.overview.final)=gsub("(","",colnames(heal.overview.final))
#colnames(heal.overview.final)=gsub(")","",colnames(heal.overview.final))
heal.overview.final=heal.overview.final[,c("geo",
"Current.health.expenditure.(%.of.GDP)",
"HIV.prevalence.adult.(%.ages.15-49)",
"Life.expectancy.at.birth.(years)",
"Mortality.rate.infant.(per.1000.live.births)",
"Mortality.rate.under-five.(per.1000.live.births)")]
heal.overview.final[is.na(heal.overview.final)]=0
heal.overview.final$`HIV.prevalence.adult.(%.ages.15-49)`=heal.overview.final$`HIV.prevalence.adult.(%.ages.15-49)`*10
colnames(heal.overview.final)[3]="HIV.prevalence.adult.(per.1000.ages.15-49)"
heal.life1=hdi.databank.m %>%
filter( Region %in%  heal.geography.in) %>%
filter((year>= date_from) & (year<= date_to)) %>%
filter( indicator_name =="Life expectancy at birth (years)")%>%
select(Region,year,hdi)%>%arrange(year,Region)%>%drop_na(hdi)%>%
group_by(year,Region)%>%  summarise(avg = mean(hdi))
heal.life2=hdi.databank.m %>%
filter( country_name %in%  heal.geography.in) %>%
filter((year>= date_from) & (year<= date_to)) %>%
filter( indicator_name =="Life expectancy at birth (years)")%>%
select(country_name,year,hdi)%>%arrange(year,country_name)%>%drop_na(hdi)%>%
group_by(year,country_name)%>%  summarise(avg = mean(hdi))
colnames(heal.life2)[2]="Region"
heal.life <- rbind(heal.life1,heal.life2)
colnames(heal.life)[2]="geo"
#
# heal.life1=hdi.databank.m %>%
#   filter( Region %in% heal.geography.in) %>%
#   filter((year>= date_from) & (year<= date_to)) %>%
#   filter( indicator_name =="Life expectancy at birth (years)")%>%
#   group_by(year,country_name)
# radar=ggradar(heal.overview.final,grid.mid = 50,grid.max = 100)
# hiv.plot=ggplot(data=heal.overview.final,mapping = aes(x=geo,y=`HIV.prevalence.adult.(per.1000.ages.15-49)`))+
#   geom_bar(stat="identity")+
#   coord_flip()
}else{
heal.overview <- hdi.databank.m %>%
filter( level %in% heal.level.in) %>%
filter((year>= date_from) & (year<= date_to)) %>%
replace_na(list(hdi=0))%>%
group_by(level,indicator_name)%>%summarise(avg = mean(hdi))
heal.overview.final=heal.overview%>%spread(indicator_name,avg)
colnames(heal.overview.final)=gsub(" ",".",colnames(heal.overview.final))
colnames(heal.overview.final)=gsub(",","",colnames(heal.overview.final))
#colnames(heal.overview.final)=gsub("(","",colnames(heal.overview.final))
#colnames(heal.overview.final)=gsub(")","",colnames(heal.overview.final))
heal.overview.final=heal.overview.final[,c("level",
"Current.health.expenditure.(%.of.GDP)",
"HIV.prevalence.adult.(%.ages.15-49)",
"Life.expectancy.at.birth.(years)",
"Mortality.rate.infant.(per.1000.live.births)",
"Mortality.rate.under-five.(per.1000.live.births)")]
heal.overview.final[is.na(heal.overview.final)]=0
heal.overview.final$`HIV.prevalence.adult.(%.ages.15-49)`=heal.overview.final$`HIV.prevalence.adult.(%.ages.15-49)`*10
colnames(heal.overview.final)[3]="HIV.prevalence.adult.(per.1000.ages.15-49)"
heal.life=hdi.databank.m %>%
filter( level %in%  heal.level.in) %>%
filter((year>= date_from) & (year<= date_to)) %>%
filter( indicator_name =="Life expectancy at birth (years)")%>%
select(level,year,hdi)%>%arrange(year,level)%>%drop_na(hdi)%>%
group_by(year,level)%>%  summarise(avg = mean(hdi))
# radar=ggradar(heal.overview.final,grid.mid = 50,grid.max = 100)
# hiv.plot=ggplot(data=heal.overview.final,mapping = aes(x=level,y=`HIV.prevalence.adult.(per.1000.ages.15-49)`))+
#   geom_bar(stat="identity")+
#   coord_flip()
}
return(heal.overview.final)
}
heal.level.in=as.null()
#heal.level.in=c("VERY HIGH HUMAN DEVELOPMENT","LOW HUMAN DEVELOPMENT","MEDIUM HUMAN DEVELOPMENT","HIGH HUMAN DEVELOPMENT")
heal.overview.test=test_heal_plot_fun(heal.level.in,date_from=2013,date_to=2016,
heal.geography.in=c("Arab State","Botswana","Central African Republic","Congo"),plot_type = "")
View(heal.overview.test)
View(heal.overview.test)
heal.overview.test%>%select(c(1,5,6))
colnames(heal.overview.test)
heal.overview.test%>%select(c(1,5,6))%>%gather(key="mortal.index",
"Mortality.rate.infant.(per.1000.live.births)",
"Mortality.rate.under-five.(per.1000.live.births)",
value = "values")
View(heal.overview.test)
test=heal.overview.test%>%select(c(1,5,6))%>%gather(key="mortal.index",
"Mortality.rate.infant.(per.1000.live.births)",
"Mortality.rate.under-five.(per.1000.live.births)",
value = "values")
View(test)
ggplot(data=test)+geom_bar(aes(x=geo,y=value,fill=mortal.index),position = "stock")
ggplot(data=test)+geom_bar(aes(x=geo,y=value,fill=mortal.index),position = "stack")
View(heal.overview.test)
ggplot(data=test)+geom_bar(aes(x=geo,y=values,fill=mortal.index),position = "stack")
ggplot(data=test)+geom_bar(aes(x=geo,y=values,fill=mortal.index),stat = "identity",position = "stack")
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
View(hdi.databank.m)
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
icon
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
runApp('hdi')
out <- capture.output(
bw_iris <- np::npregbw(formula = Petal.Length ~ Sepal.Width + Species,
data = iris)
)
library(np)
install.packages(np)
install.packages("np")
out <- capture.output(
bw_iris <- np::npregbw(formula = Petal.Length ~ Sepal.Width + Species,
data = iris)
)
bw_iris
# Regression
fit_iris <- np::npreg(bw_iris)
summary(fit_iris)
# Plot marginal effects of each predictor on the response
par(mfrow = c(1, 2))
plot(fit_iris, plot.par.mfrow = FALSE)
data(oecdpanel, package = "np")
# Bandwidth by CV for local constant -- use only two starts to reduce the
# computation time
out <- capture.output(
bw_OECD <- np::npregbw(formula = growth ~ factor(oecd) + ordered(year) +
initgdp + popgro + inv + humancap, data = oecdpanel,
regtype = "lc", nmulti = 2)
)
View(oecdpanel)
bw_OECD
# Bandwidth by CV for local constant -- use only two starts to reduce the
# computation time
out <- capture.output(
bw_OECD <- np::npregbw(formula = growth ~ factor(oecd) + ordered(year) +
initgdp + popgro + inv + humancap, data = oecdpanel,
regtype = "lc", nmulti = 2)
)
data(Auto, package = "ISLR")
Auto
data(Auto, package = "ISLR")
# Bandwidth by CV for local constant -- use only two starts to reduce the
# computation time
out <- capture.output(
bw_OECD <- np::npregbw(formula = mpg ~ ordered(cylinders) +
horsepower + weight + origin data = Auto,
regtype = "lc", nmulti = 2)
)
bw_OECD
data(Auto, package = "ISLR")
# Bandwidth by CV for local constant -- use only two starts to reduce the
# computation time
out <- capture.output(
bw_OECD <- np::npregbw(formula = mpg ~ ordered(cylinders) +
horsepower + weight + origin, data = Auto,
regtype = "lc", nmulti = 2)
)
bw_OECD
# Regression
fit_OECD <- np::npreg(bw_OECD)
summary(fit_OECD)
# Plot marginal effects of each predictor on the response
par(mfrow = c(2, 3))
plot(fit_OECD, plot.par.mfrow = FALSE)
Auto
data(Auto, package = "ISLR")
# Bandwidth by CV for local constant -- use only two starts to reduce the
# computation time
out <- capture.output(
bw_OECD <- np::npregbw(formula = mpg ~ ordered(cylinders) +
horsepower + weight + factor(origin), data = Auto,
regtype = "lc", nmulti = 2)
)
bw_OECD
data(Auto, package = "ISLR")
# Bandwidth by CV for local constant -- use only two starts to reduce the
# computation time
out <- capture.output(
bw_OECD <- np::npregbw(formula = mpg ~ ordered(cylinders) +
horsepower + weight + ordered(origin), data = Auto,
regtype = "lc", nmulti = 2)
)
bw_OECD
data(Auto, package = "ISLR")
# Bandwidth by CV for local constant -- use only two starts to reduce the
# computation time
out <- capture.output(
bw_OECD <- np::npregbw(formula = mpg ~ ordered(cylinders) +
horsepower + weight + factor(origin), data = Auto,
regtype = "lc", nmulti = 2)
)
bw_OECD
fit_OECD <- np::npreg(bw_OECD)
summary(fit_OECD)
par(mfrow = c(2, 3))
plot(fit_OECD, plot.par.mfrow = FALSE)
n <- 200
logistic <- function(x) 1 / (1 + exp(-x))
p <- function(x) logistic(1 - 3 * sin(x))
set.seed(123456)
X <- runif(n = n, -3, 3)
Y <- rbinom(n = n, size = 1, prob = p(X))
# Set bandwidth and evaluation grid
h <- 0.25
x <- seq(-3, 3, l = 501)
suppressWarnings(
fit_glm <- sapply(x, function(x) {
K <- dnorm(x = x, mean = X, sd = h)
glm.fit(x = cbind(1, X - x), y = Y, weights = K,
family = binomial())$coefficients[1]
})
)
suppressWarnings(
fit_nlm <- sapply(x, function(x) {
K <- dnorm(x = x, mean = X, sd = h)
nlm(f = function(beta) {
-sum(K * (Y * (beta[1] + beta[2] * (X - x)) -
log(1 + exp(beta[1] + beta[2] * (X - x)))))
}, p = c(0, 0))$estimate[1]
})
)
# Approach 3: employ locfit::locfit
# Bandwidth can not be controlled explicitly - only through nn in ?lp
fit_locfit <- locfit::locfit(Y ~ locfit::lp(X, deg = 1, nn = h),
family = "binomial", kern = "gauss")
install.packages("locfit")
# Approach 3: employ locfit::locfit
# Bandwidth can not be controlled explicitly - only through nn in ?lp
fit_locfit <- locfit::locfit(Y ~ locfit::lp(X, deg = 1, nn = h),
family = "binomial", kern = "gauss")
plot(x, p(x), ylim = c(0, 1.5), type = "l", lwd = 2)
lines(x, logistic(fit_glm), col = 2)
lines(x, logistic(fit_nlm), col = 2, lty = 2)
plot(fit_locfit, add = TRUE, col = 4)
legend("topright", legend = c("p(x)", "glm", "nlm", "locfit"), lwd = 2,
col = c(1, 2, 2, 4), lty = c(1, 2, 1, 1))
plot(x, p(x), ylim = c(0, 1.5), type = "l", lwd = 2)
lines(x, logistic(fit_glm), col = 2)
lines(x, logistic(fit_nlm), col = 2, lty = 2)
plot(fit_locfit, add = TRUE, col = 4)
legend("topright", legend = c("p(x)", "glm", "nlm", "locfit"), lwd = 2,
col = c(1, 2, 2, 4), lty = c(1, 2, 1, 1))
h <- seq(0.1, 2, by = 0.1)
suppressWarnings(
LCV <- sapply(h, function(h) {
sum(sapply(1:n, function(i) {
K <- dnorm(x = X[i], mean = X[-i], sd = h)
nlm(f = function(beta) {
-sum(K * (Y[-i] * (beta[1] + beta[2] * (X[-i] - X[i])) -
log(1 + exp(beta[1] + beta[2] * (X[-i] - X[i])))))
}, p = c(0, 0))$minimum
}))
})
)
plot(h, LCV, type = "o")
abline(v = h[which.max(LCV)], col = 2)
n <- 20
mu0 <- 2; sd0 <- 1
set.seed(12341)
samp <- rnorm(n = n, mean = mu0, sd = sd0)
# Fn vs F0
plot(ecdf(samp), main = "", ylab = "Probability")
curve(pnorm(x, mean = mu0, sd = sd0), add = TRUE, col = 2)
# Maximum distance
samp_sorted <- sort(samp)
Ui <- pnorm(samp_sorted, mean = mu0, sd = sd0)
Dn_plus <- (1:n) / n - Ui
Dn_minus <- Ui - (1:n - 1) / n
i <- which.max(pmax(Dn_plus, Dn_minus))
lines(rep(samp_sorted[i], 2),
c(i / n, pnorm(samp_sorted[i], mean = mu0, sd = sd0)),
col = 4, lwd = 2)
rug(samp)
legend("topleft", lwd = 2, col = c(1:2, 4),
legend = latex2exp::TeX(c("$F_n$", "$F_0$", "sup_x|F_n(x)-F_0(x)|")))
n <- 50
set.seed(3245678)
x <- rnorm(n = n)
# Kolmogorov-Smirnov test for H_0: F = N(0, 1). Does not reject.
(ks <- ks.test(x = x, y = "pnorm")) # In "y" we specify the cdf F0 as a function
# Structure of "htest" class
str(ks)
# Kolmogorov-Smirnov test for H_0: F = N(0.5, 1). Rejects.
ks.test(x = x, y = "pnorm", mean = 0.5)
# Kolmogorov-Smirnov test for H_0: F = Exp(2). Strongly rejects.
ks.test(x = x, y = "pexp", rate = 1/2)
##
##
##  One-sample Kolmogorov-Smirnov test
##
##  One-sample Kolmogorov-Smirnov test
##
##
##  One-sample Kolmogorov-Smirnov test
##
## data:  x
##
##  One-sample Kolmogorov-Smirnov test
##
## data:  x
## D = 0.53495, p-value = 6.85e-14
##
##  One-sample Kolmogorov-Smirnov test
##
## data:  x
## D = 0.53495, p-value = 6.85e-14
## alternative hypothesis: two-sided
##
##  One-sample Kolmogorov-Smirnov test
##
## data:  x
## D = 0.53495, p-value = 6.85e-14
## alternative hypothesis: two-sided
View(hdi.databank.m)
shiny::runApp('hdi')
install.packages("leaflet")
library(leaflet)
library(leaflet)
m <- leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addMarkers(lng=174.768, lat=-36.852, popup="The birthplace of R")
m
world <- map("world", fill=TRUE, plot=FALSE)
library(sp)
library(maps)
library(maptools)
world <- map("world", fill=TRUE, plot=FALSE)
world_map <- map2SpatialPolygons(world, sub(":.*$", "", world$names))
View(world_map)
View(world)
world$x
world$names
View(hdi.databank.m)
library(rworldmap)
install.packages('rworldmap')
map=getMap()
library(rworldmap)
map=getMap()
plot(map)
library(tidyverse)
map$ISO3.1
View(hdi.databank.m)
View(hdi.databank.m)
demo.data<-hdi.databank.m%>%filter(indicator_name %in%
c("Total population (millions)","Urban population (%)","Young age (0-14) dependency ratio (per 100 people ages 15-64)","Old-age (65 and older) dependency ratio (per 100 people ages 15-64)"))
View(demo.data)
union(demo.data$indicator_name)
unique(demo.data$indicator_name)
colnames(hdi.databank.m)
demo.data<-hdi.databank.m%>%filter(indicator_name %in%
c("Total population (millions)","Urban population (%)",
"Young age (0-14) dependency ratio (per 100 people ages 15-64)",
"Old-age (65 and older) dependency ratio (per 100 people ages 15-64)"))%>%
select(iso3,country_name,year,hdi,level,Region)
View(demo.data)
demo.data<-hdi.databank.m%>%filter(indicator_name %in%
c("Total population (millions)","Urban population (%)",
"Young age (0-14) dependency ratio (per 100 people ages 15-64)",
"Old-age (65 and older) dependency ratio (per 100 people ages 15-64)"))%>%
filter(year==2017)%>%
select(iso3,country_name,year,hdi,level,Region)
View(demo.data)
demo.data<-hdi.databank.m%>%filter(indicator_name %in%
c("Total population (millions)","Urban population (%)",
"Young age (0-14) dependency ratio (per 100 people ages 15-64)",
"Old-age (65 and older) dependency ratio (per 100 people ages 15-64)"))%>%
filter(year==2017)%>%
select(iso3,country_name,year,indicator_name,hdi,level,Region)%>%
spread(indicator_name,hdi)
View(demo.data)
demo.data<-hdi.databank.m%>%filter(indicator_name %in%
c("Total population (millions)","Urban population (%)",
"Young age (0-14) dependency ratio (per 100 people ages 15-64)",
"Old-age (65 and older) dependency ratio (per 100 people ages 15-64)"))%>%
filter(year==2017)%>%
select(iso3,country_name,year,indicator_name,hdi,level,Region)%>%
spread(indicator_name,hdi)
colnames(demo.data)=gsub(" ",".",colnames(demo.data))
colnames(demo.data)=gsub("%","per",colnames(demo.data))
View(demo.data)
library(leaflet)
library(rworldmap)
map=getMap()
plot(map)
demo.data<-hdi.databank.m%>%filter(indicator_name %in%
c("Total population (millions)","Urban population (%)",
"Young age (0-14) dependency ratio (per 100 people ages 15-64)",
"Old-age (65 and older) dependency ratio (per 100 people ages 15-64)"))%>%
filter(year==2017)%>%
select(iso3,country_name,year,indicator_name,hdi,level,Region)%>%
spread(indicator_name,hdi)
colnames(demo.data)=gsub(" ",".",colnames(demo.data))
colnames(demo.data)=gsub("%","per",colnames(demo.data))
>>>>>>> d04a43dc335f2038c20eb0d7963d511b9c899551
